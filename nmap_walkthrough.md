## Nmap walkthrough steps
-------------------------

### Host Discovery - Generate Live Hosts List

```
nmap -sn -T4 -oG Discovery.gnmap 192.168.56.0/24
grep "Status: Up" Discovery.gnmap | cut -f 2 -d ' ' > LiveHosts.txt
```

### Port Discovery - Most Common Ports
##### http://nmap.org/presentations/BHDC08/bhdc08-slides-fyodor.pdf

```
nmap -sS -T4 -Pn -oG TopTCP -iL LiveHosts.txt
nmap -sU -T4 -Pn -oN TopUDP -iL LiveHosts.txt
nmap -sS -T4 -Pn --top-ports 3674 -oG 3674 -iL LiveHosts.txt
```

### Port Discovery - Full Port Scans (UDP is very slow)

```
nmap -sS -T4 -Pn -p 0-65535 -oN FullTCP -iL LiveHosts.txt
nmap -sU -T4 -Pn -p 0-65535 -oN FullUDP -iL LiveHosts.txt
```

### Print TCP\UDP Ports

```
grep "open" FullTCP|cut -f 1 -d ' ' | sort -nu | cut -f 1 -d '/' |xargs | sed 's/ /,/g'|awk '{print "T:"$0}'
grep "open" FullUDP|cut -f 1 -d ' ' | sort -nu | cut -f 1 -d '/' |xargs | sed 's/ /,/g'|awk '{print "U:"$0}'
```

### Detect Service Version

```
nmap -sV -T4 -Pn -oG ServiceDetect -iL LiveHosts.txt
```

### Operating System Scan

```
nmap -O -T4 -Pn -oG OSDetect -iL LiveHosts.txt
```

### OS and Service Detect

```
nmap -O -sV -T4 -Pn -p U:53,111,137,T:21-25,80,139,8080 -oG OS_Service_Detect -iL LiveHosts.txt
```

### fragmentation
nmap -f

### change default MTU size number must be a multiple of 8 (8,16,24,32 etc)
nmap --mtu 24

### Generates a random number of decoys
nmap -D RND:10 [target]

### Manually specify the IP addresses of the decoys
nmap -D decoy1,decoy2,decoy3 etc.

### Idle Zombie Scan, first t need to find zombie ip
nmap -sI [Zombie IP] [Target IP]

### Source port number specification
nmap --source-port 80 IP

### Append Random Data to scan packages
nmap --data-length 25 IP

### MAC Address Spoofing, generate different mac for host pc
nmap --spoof-mac Dell/Apple/3Com IP


### Scan optimizations

#### TCP-Full 
--------------
nmap -sT -vv -r -p- -Pn -T2 --reason --open --scan-delay 10 --min-parallelism 10  --max-rate 100  --max-retries 2  -oA tcp_ports_full  x.x.x.x/CIDR

#### FIN Scan
--------------
nmap -sF -vv -r -p- -Pn -T2 --reason --open --scan-delay 10 --min-parallelism 10  --max-rate 100  --max-retries 2  -oA tcp_ports_fin x.x.x.x/CIDR

#### XMAS Scan
-----------------
nmap -sX -vv -r -p- -Pn -T2 --reason --open --scan-delay 10 --min-parallelism 10  --max-rate 100  --max-retries 2  -oA tcp_ports_xmas  x.x.x.x/CIDR  
 
#### Syn Scan 
-------------

nmap -sS -vv -r -p- -Pn -T2 --reason --open --scan-delay 10 --min-parallelism 10  --max-rate 100  --max-retries 2  -oA tcp_ports_syn  x.x.x.x/CIDR  

#### UDP 
--------
nmap -sU -T2 -Pn -r --top-ports 100 -vv  -reason --open --scan-delay 10 --min-parallelism 10  --max-rate 100  --max-retries 2  -oA udp_ports  x.x.x.x/CIDR


