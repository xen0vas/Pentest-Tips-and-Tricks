## Nmap walkthrough steps
-------------------------

### Host Discovery - Generate Live Hosts List

```
nmap -sn -T4 -oG Discovery.gnmap 192.168.56.0/24
grep "Status: Up" Discovery.gnmap | cut -f 2 -d ' ' > LiveHosts.txt
```

### Port Discovery - Most Common Ports
##### http://nmap.org/presentations/BHDC08/bhdc08-slides-fyodor.pdf

```
nmap -sS -T4 -Pn -oG TopTCP -iL LiveHosts.txt
nmap -sU -T4 -Pn -oN TopUDP -iL LiveHosts.txt
nmap -sS -T4 -Pn --top-ports 3674 -oG 3674 -iL LiveHosts.txt
```

### Port Discovery - Full Port Scans (UDP is very slow)

```
nmap -sS -T4 -Pn -p 0-65535 -oN FullTCP -iL LiveHosts.txt
nmap -sU -T4 -Pn -p 0-65535 -oN FullUDP -iL LiveHosts.txt
```

### Print TCP\UDP Ports

```
grep "open" FullTCP|cut -f 1 -d ' ' | sort -nu | cut -f 1 -d '/' |xargs | sed 's/ /,/g'|awk '{print "T:"$0}'
grep "open" FullUDP|cut -f 1 -d ' ' | sort -nu | cut -f 1 -d '/' |xargs | sed 's/ /,/g'|awk '{print "U:"$0}'
```

### Detect Service Version

```
nmap -sV -T4 -Pn -oG ServiceDetect -iL LiveHosts.txt
```

### Operating System Scan

```
nmap -O -T4 -Pn -oG OSDetect -iL LiveHosts.txt
```

### OS and Service Detect

```
nmap -O -sV -T4 -Pn -p U:53,111,137,T:21-25,80,139,8080 -oG OS_Service_Detect -iL LiveHosts.txt
```
