
## Mona tool in Imunity Debugger 
-------------------------------------

#### Create an output folder for mona inside logs folder

```
!mona config -set workingfolder c:\logs\%p
```

#### The command creates the file c:\logs\<executable_name>\pattern.txt with the cyclic pattern inside

```
!mona pc 6000
```

#### shows the distance to the four bytes that control EIP, in the log window of Immunity.

```
!mona pattern_offset <offset> (where <offset> is the value of EIP at the crash time)
```

#### the command below offers the following

##### - Looking for cyclic pattern in memory
##### - Examining SEH chain
##### - Examining stack (entire stack) - looking for cyclic pattern
##### - Examining stack (entire stack) - looking for pointers to cyclic pattern

```
!mona findmsp
```

#### jump to ESP inside the process binary and the DLLs loaded in memory on execution time (by default it looks in all DLLs loaded in memory (Use the *-m* switch to make it search in DLLs passed as parameters). The result is stored in the file *c:\logs\<executable_name>\jmp.txt*.

```
!mona jmp -r ESP
```

#### create the byte array

```
!mona bytearray
```

#### Return Oriented Programming (ROP) 

##### https://en.wikipedia.org/wiki/Return-oriented_programming
##### https://en.wikipedia.org/wiki/Data_Execution_Prevention

```
!mona modules
!mona ropfunc -m *.dll -cpb "<bad_chars>"
!mona rop -m *.dll -cpb "<bad_chars>" (auto suggest)
!mona rop -n -o -m dll1,dll2,dll3 -cpb "<bad_chars>"
!mona rop -n -o 
```

## ROPgadget tool 

##### https://github.com/JonathanSalwan/ROPgadget

--------------------

```
python ROPgadget.py --binary "C:\Program Files (x86)\<vuln_app>\<dll_to_search_gadgets>.dll" --only "xchg|ret|pop|xor" --depth 5 --badbytes ""00|0a|0d" > gadgets.txt
```

```
python ROPgadget.py --binary "C:\Program Files (x86)\<vuln_app>\<dll_to_search_gadgets>.dll" --only "xchg|ret|pop|xor" --badbytes "00|0a|0d" > gadgets.txt
```

## EGG Hunter

```
# https://www.corelan.be/index.php/2010/01/09/exploit-writing-tutorial-part-8-win32-egg-hunting/
# http://www.fuzzysecurity.com/tutorials/expDev/4.html
!mona jmp -r esp
!mona egg -t w00t
\xeb\xc4 (jump backward -60)
buff=w00tw00t+shell
!mona egg -t 'w00t'
msf-egghunter -b "\x00" -e WOOT -f c
```
